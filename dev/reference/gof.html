<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Goodness-of-fit assessment of the fitted model. — gof • occumb</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Goodness-of-fit assessment of the fitted model. — gof"><meta name="description" content="gof() calculates omnibus discrepancy measures and
their Bayesian \(p\)-values for the fitted model using the posterior
predictive check approach."><meta property="og:description" content="gof() calculates omnibus discrepancy measures and
their Bayesian \(p\)-values for the fitted model using the posterior
predictive check approach."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">occumb</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9008</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/occumb.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/model_specification.html">Model specification in occumb()</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fukayak/occumb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Goodness-of-fit assessment of the fitted model.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fukayak/occumb/blob/develop/R/gof.R" class="external-link"><code>R/gof.R</code></a></small>
      <div class="d-none name"><code>gof.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>gof()</code> calculates omnibus discrepancy measures and
their Bayesian \(p\)-values for the fitted model using the posterior
predictive check approach.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gof</span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Freeman_Tukey"</span>, <span class="st">"deviance"</span>, <span class="st">"chi_squared"</span><span class="op">)</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>An <code>occumbFit</code> object.</p></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>The discrepancy statistics to be applied.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>The number of cores to use for parallelization.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical, determine if draw scatter plots of the fit statistics.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the default <code>plot</code> method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following named elements:</p><dl><dt><code>stats</code></dt>
<dd><p>The discrepancy statistics applied.</p></dd>

<dt><code>p_value</code></dt>
<dd><p>Bayesian \(p\)-value.</p></dd>

<dt><code>stats_obs</code></dt>
<dd><p>Discrepancy statistics for observed data.</p></dd>

<dt><code>stats_rep</code></dt>
<dd><p>Discrepancy statistics for repeated data.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A discrepancy statistic for the fitted model is obtained using a
posterior predictive checking procedure.
The following statistics are currently available:</p><dl><dt>Freeman-Tukey statistics (default)</dt>
<dd><p>\(T_{\textrm{FT}} = \sum_{i,j,k}\left(\sqrt{y_{ijk}} - \sqrt{E(y_{ijk} \mid \pi_{ijk})}\right)^2\)</p></dd>

<dt>Deviance statistics</dt>
<dd><p>\(T_{\textrm{deviance}} = -2 \sum_{j,k} \log \textrm{Multinomial}(\boldsymbol{y}_{jk} \mid \boldsymbol{\pi}_{jk})\)</p></dd>

<dt>Chi-squared statistics</dt>
<dd><p>\(T_{\chi^2} = \sum_{i,j,k}\frac{\left(y_{ijk} - E(y_{ijk} \mid \pi_{ijk})\right)^2}{E(y_{ijk} \mid \pi_{ijk})}\)</p></dd>


</dl><p>where \(i\), \(j\), and \(k\) are the subscripts of species, site, and
replicate, respectively,
\(y_{ijk}\) is sequence read count data,
\(\pi_{ijk}\) is multinomial cell probabilities of sequence read
counts,
\(E(y_{ijk} \mid \pi_{ijk})\) is expected
value of the sequence read counts conditional on their cell probabilities,
and \(\log \textrm{Multinomial}(\boldsymbol{y}_{jk} \mid \boldsymbol{\pi}_{jk})\)
is the multinomial log-likelihood of the sequence read counts in replicate
\(k\) of site \(j\) conditional on their cell probabilities.</p>
<p>The Bayesian \(p\)-value is estimated as the probability that the value of
the discrepancy statistics of the replicated dataset is more extreme than that
of the observed dataset.
An extreme Bayesian \(p\)-value may indicate inadequate model fit.
See Gelman et al. (2014), Kéry and Royle (2016), and
Conn et al. (2018) for further details on the procedures used for posterior
predictive checking.</p>
<p>Computations can be run in parallel on multiple CPU cores where the <code>cores</code>
argument controls the degree of parallelization.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>P. B. Conn, D. S. Johnson, P. J. Williams, S. R. Melin and M. B. Hooten.
(2018) A guide to Bayesian model checking for ecologists.
<em>Ecological Monographs</em> <strong>88</strong>:526–542.
<a href="https://doi.org/10.1002/ecm.1314" class="external-link">doi:10.1002/ecm.1314</a></p>
<p>A. Gelman, J. B. Carlin, H. S. Stern D. B. Dunson, A. Vehtari and
D. B. Rubin (2013) <em>Bayesian Data Analysis</em>. 3rd edition.
Chapman and Hall/CRC. <a href="http://www.stat.columbia.edu/~gelman/book/" class="external-link">http://www.stat.columbia.edu/~gelman/book/</a></p>
<p>M. Kéry and J. A. Royle (2016) <em>Applied Hierarchical Modeling in
Ecology — Analysis of Distribution, Abundance and Species Richness in R
and BUGS. Volume 1: Prelude and Static Models</em>. Academic Press.
<a href="https://www.mbr-pwrc.usgs.gov/pubanalysis/keryroylebook/" class="external-link">https://www.mbr-pwrc.usgs.gov/pubanalysis/keryroylebook/</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Generate the smallest random dataset (2 species * 2 sites * 2 reps)</span></span></span>
<span class="r-in"><span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Number of species</span></span></span>
<span class="r-in"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Number of sites</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Number of replicates</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="occumbData.html">occumbData</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="va">I</span> <span class="op">*</span> <span class="va">J</span> <span class="op">*</span> <span class="va">K</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">J</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    spec_cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cov1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    site_cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cov2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    cov3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    repl_cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cov4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">J</span> <span class="op">*</span> <span class="va">K</span><span class="op">)</span>, <span class="va">J</span>, <span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fitting a null model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="occumb.html">occumb</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Processing function input....... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compiling model graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Resolving undeclared variables</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Allocating nodes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Graph information:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Observed stochastic nodes: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Unobserved stochastic nodes: 31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Total graph size: 133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initializing model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adaptive phase..... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adaptive phase complete </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Burn-in phase, 10000 iterations x 4 chains </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling from joint posterior, 10000 iterations x 4 chains </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating statistics....... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Goodness-of-fit assessment</span></span></span>
<span class="r-in"><span><span class="va">gof_result</span> <span class="op">&lt;-</span> <span class="fu">gof</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gof-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">gof_result</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Posterior predictive check for an occumbFit object:</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Statistics: Freeman-Tukey </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  p-value:    0.47175 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Discrepancy statistics for observed data:   1.18 (mean), 0.61 (sd) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Discrepancy statistics for replicated data: 1.32 (mean), 1.1 (sd) </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keiichi Fukaya, Mika Takahashi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

